---
import InputField from "@components/InputField.astro";
import AuthLayout from "@layouts/AuthLayout.astro";

import arrowIcon from "@assets/icons/Arrow.svg";
import ActionButton from "@components/ActionButton.astro";
---

<AuthLayout>
    <div
        class="flex flex-col items-center justify-start shrink-0 w-[1003px] mb-4"
    >
        <div
            class="top-12 text-text text-center relative self-stretch"
            style="font: 900 90px 'Montserrat', sans-serif"
        >
            Create Account
        </div>

        <form
            class="bg-highlight rounded-[100px] pt-20 pr-10 pb-[50px] pl-10 flex flex-col gap-20 items-center justify-center self-stretch shrink-0"
            style="box-shadow: 4px 4px 4px 0px rgba(0, 0, 0, 0.2);"
            action=`/api/auth/register`
            method="post"
            autocomplete="off"
        >
            <div
                class="flex flex-col gap-[25px] items-center justify-center self-stretch shrink-0 relative"
            >
                <InputField name="Email" type="email" id="email" />
                <InputField name="Password" type="password" id="password" />
                <div
                    class="w-full -m-5 pl-20 text-[#f16c64] italic hidden"
                    id="invalidPw"
                >
                    *Warning
                </div>
                <InputField
                    name="Repeat Password"
                    type="password"
                    id="repeat-password"
                />
                <div
                    class="w-full -m-5 pl-20 text-[#f16c64] italic"
                    id="invalidRpPw"
                >
                    *Warning
                </div>
            </div>

            <ActionButton
                id="register"
                style="positive"
                text="Sign me UPPP!!!!"
                rightIcon={arrowIcon}
                hasSpacer={true}
                textSize={35}
            />

            <div
                class="p-2.5 flex flex-col gap-2.5 items-center justify-center shrink-0 w-[407px] relative overflow-hidden"
            >
                <div
                    class="pt-0 pr-5 pb-0 pl-5 flex flex-row gap-2.5 items-center justify-start self-stretch shrink-0 relative"
                >
                    <div
                        class="text-text text-left relative"
                        style="font: 500 20px 'Montserrat', sans-serif"
                    >
                        Already have an account?
                    </div>

                    <a
                        class="text-action text-left relative"
                        style="
                            font: 500 20px 'Montserrat', sans-serif;
                            text-decoration: underline;
                        "
                        href="/signin"
                    >
                        Sign in!
                    </a>
                </div>
            </div>
        </form>
    </div>
</AuthLayout>

<script>
    const invalidMessages =
                document.getElementById("invalidRpPw");
            invalidMessages.style.visibility = "hidden";


    const signUpBtn = document.getElementById("register");
    signUpBtn.addEventListener("click", () => {
        const pwField = document
            .getElementById("password")
            .getElementsByTagName("input")[0];
        const repeatPwField = document
            .getElementById("repeat-password")
            .getElementsByTagName("input")[0];
        if (pwField.value != repeatPwField.value) {
            
            invalidMessages.style.visibility = "visible";
            invalidMessages.textContent =
                "*New password does not match! Retype the new password here.";
        }
    });
</script>
